Search.setIndex({"docnames": ["cov", "index", "inference", "model", "parameters", "util"], "filenames": ["cov.rst", "index.rst", "inference.rst", "model.rst", "parameters.rst", "util.rst"], "titles": ["Covariance Functions", "Installation", "Inference", "Model", "Parameter Selection", "Utilities"], "terms": {"thi": [0, 1, 3], "section": 0, "show": 0, "differ": 0, "wai": 0, "us": [0, 1, 2, 3], "suppli": [0, 3], "defin": [0, 2], "your": [0, 1, 3], "own": [0, 1, 3], "The": [0, 1, 2, 3, 4, 5], "cov_func_curri": [0, 3, 4], "argument": [0, 3], "model": [0, 1], "class": [0, 3], "support": [0, 3, 4], "one": [0, 3], "type": [0, 2, 3, 4, 5], "return": [0, 1, 2, 3, 4, 5], "k": [0, 1, 2, 3, 4], "x": [0, 1, 2, 3, 4, 5], "y": [0, 1, 2, 3, 4, 5], "rightarrow": [0, 2, 3, 4], "float": [0, 2, 3, 4, 5], "In": 0, "case": [0, 3], "length": [0, 1, 3, 4], "scale": [0, 1, 3, 4], "comput": [0, 1, 2, 3, 4, 5], "automat": [0, 1, 3], "pass": [0, 3], "an": [0, 1, 3, 4], "altern": [0, 1], "can": [0, 1, 2, 3], "set": [0, 1, 3, 5], "cov_func": [0, 1, 2, 3, 4], "take": [0, 3], "two": 0, "arrai": [0, 2, 3, 4, 5], "cell": [0, 1], "state": [0, 1, 2, 3], "similat": 0, "between": [0, 1, 3, 4, 5], "each": [0, 1, 2, 3, 4, 5], "pair": [0, 1], "predefin": 0, "default": [0, 1, 2, 3, 4, 5], "behavior": 0, "from": [0, 1, 3, 4], "mellon": [0, 1, 2, 3, 4, 5], "import": [0, 1], "matern52": [0, 1, 3], "cov_func_curi": 0, "length_scal": [0, 1], "write": 0, "variabl": [0, 3], "distanc": [0, 1, 2, 3, 4, 5], "point": [0, 2, 3, 4, 5], "def": [0, 1], "l": [0, 1, 2, 3, 4], "1": [0, 1, 2, 3, 4, 5], "0": [0, 1, 2, 3, 4], "r": 0, "similar": [0, 1], "sqrt": 0, "5": 0, "squar": [0, 5], "3": 0, "exp": 0, "inherit": 0, "base": [0, 1, 3], "__call__": 0, "method": [0, 3, 4], "call": [0, 3], "__init__": 0, "self": [0, 3], "super": 0, "simialar": 0, "upport": 0, "ad": [0, 3, 5], "multipli": 0, "power": 0, "oper": 0, "combin": 0, "expquad": [0, 1], "7": 0, "cov": [0, 3], "e": [0, 1, 2, 3], "frac": 0, "2": [0, 3, 4, 5], "exponenti": [0, 2], "2l": 0, "matern32": 0, "cdot": [0, 3, 4, 5], "3l": 0, "ratquad": 0, "alpha": 0, "i": [1, 2, 3, 4], "non": [1, 3], "parametr": [1, 3], "densiti": [1, 2, 3, 5], "estim": [1, 3, 5], "nearestneighbor": 1, "distribut": [1, 5], "To": 1, "pip": 1, "you": [1, 3], "run": [1, 3], "scd": [], "numpi": 1, "np": 1, "random": 1, "rand": 1, "100": [1, 2, 3], "10": [1, 3, 4], "dimension": [1, 2, 3, 4, 5], "represent": [1, 3], "arbitrari": [1, 3], "test": [1, 3], "data": [1, 2, 3, 4, 5], "densityestim": [1, 3], "log_density_x": [1, 2, 3], "fit_predict": [1, 3], "log_density_i": 1, "predict": [1, 3], "popular": 1, "singl": 1, "analysi": 1, "toolkit": 1, "conjunct": 1, "we": 1, "recomend": 1, "diffus": 1, "map": [1, 2, 3], "latent": [1, 3], "input": [1, 2], "represnt": 1, "ensur": [1, 3], "euclidian": 1, "relat": 1, "disimilar": 1, "some": 1, "confound": 1, "nois": 1, "remov": 1, "approxim": [1, 3, 4], "phenotyp": 1, "manifold": [1, 3], "sc": 1, "adata": 1, "read": 1, "h5ad_file_path": 1, "extern": 1, "tl": 1, "palantir": 1, "ob": 1, "log_dens": [1, 3], "obsm": 1, "dm_eigenvector": 1, "subset": 1, "complet": 1, "dataset": 1, "evalu": 1, "all": [1, 3], "mask": 1, "condit": [1, 2], "subset_valu": 1, "fit": [1, 3], "log_density_condit": 1, "abov": 1, "ar": [1, 3], "follow": 1, "code": 1, "equival": 1, "ani": 1, "chang": 1, "desir": 1, "nearest": [1, 2, 3, 4, 5], "neighbor": [1, 2, 3, 4, 5], "nn_distanc": [1, 2, 3, 4, 5], "compute_nn_dist": [1, 4], "One": 1, "aspect": 1, "infer": [1, 3], "through": 1, "control": 1, "rate": [1, 2, 3], "realiz": 1, "kernel": 1, "function": [1, 2, 3, 4], "covari": [1, 2, 3, 4], "log": [1, 2, 3, 4, 5], "valu": [1, 2, 3, 4], "By": 1, "heurist": 1, "produc": 1, "twice": 1, "differenti": 1, "reason": 1, "varianc": 1, "bia": 1, "choic": 1, "g": [1, 2], "increas": 1, "reduc": 1, "compute_l": [1, 4], "landmark": [1, 2, 3, 4], "structur": 1, "henc": 1, "proxi": 1, "while": 1, "mean": [1, 2, 3, 4], "cluster": 1, "centroid": [1, 3, 4], "preform": 1, "best": 1, "our": 1, "number": [1, 2, 3, 4], "limit": 1, "rank": [1, 3, 4], "result": [1, 2, 3], "matrix": [1, 2, 3, 4, 5], "n_landmark": [1, 3, 4], "5000": [1, 3, 4], "k_mean": 1, "n_init": 1, "further": 1, "improv": 1, "nystr\u00f6m": 1, "either": 1, "select": [1, 3], "fraction": 1, "total": 1, "sum": [1, 3, 4], "eigenvalu": [1, 3, 4], "preserv": 1, "integ": [1, 2], "choleski": 1, "factor": 1, "999": [1, 3, 4], "assum": 1, "vari": 1, "along": 1, "its": [1, 3, 4], "dimens": [1, 2, 5], "howev": 1, "known": 1, "local": [1, 3, 4, 5], "onli": 1, "subspac": 1, "tangenti": 1, "should": 1, "d": [1, 2, 3, 4, 5], "correctli": 1, "shape": [1, 3], "suggest": 1, "mu": [1, 2, 3, 4], "gaussian": [1, 2, 3, 4], "process": [1, 2, 3, 4], "invari": 1, "A": [1, 2, 3, 4, 5], "low": [1, 3, 4], "drop": 1, "quickli": 1, "awai": [1, 3], "compute_mu": [1, 4], "initi": [1, 2, 3, 4], "ridg": [1, 4], "regress": [1, 4], "speed": 1, "up": 1, "optim": [1, 2, 3, 4], "initial_paramet": 1, "compute_initial_valu": [1, 4], "instead": 1, "mai": 1, "split": 1, "train": [1, 2, 3, 4], "three": 1, "prepare_infer": [1, 3], "run_infer": [1, 3], "process_infer": [1, 3], "allow": 1, "make": 1, "intermedi": [1, 3], "For": 1, "exampl": 1, "would": [1, 3], "like": [1, 2, 3, 4, 5], "o": 1, "replac": 1, "loss_func": [1, 2, 3], "optimal_paramet": 1, "pre_transform": [1, 2, 3], "after": 1, "gradient": [1, 3], "hessian": [1, 3], "Of": 1, "cours": 1, "also": [1, 3], "work": 1, "compute_conditional_mean": 2, "jitter": [2, 3, 4, 5], "1e": [2, 3, 4, 5], "06": [2, 3, 4, 5], "build": [2, 3], "paramet": [2, 3, 5], "instanc": [2, 3, 4], "none": [2, 3, 4], "origin": 2, "small": [2, 3, 4, 5], "amount": [2, 3, 4, 5], "add": [2, 3, 4, 5], "diagon": [2, 3, 4, 5], "stabil": [2, 3, 5], "6": [2, 3, 4, 5], "conditional_mean": 2, "compute_log_density_x": 2, "transform": [2, 3], "z": [2, 3, 4], "sim": [2, 3], "text": [2, 3, 4, 5], "normal": [2, 3], "f": 2, "where": [2, 3, 4], "ident": [2, 3], "approx": [2, 3, 4], "top": [2, 3, 4], "compute_loss_func": 2, "bayesian": [2, 3], "loss": [2, 3], "prior": [2, 3], "likelihood": [2, 3, 5], "observ": [2, 4, 5], "int": [2, 3, 4, 5], "compute_transform": 2, "minimize_adam": 2, "initial_valu": [2, 3, 4], "n_iter": [2, 3], "init_learn_r": [2, 3], "jit": [2, 3], "fals": [2, 3], "minim": [2, 3, 4], "start": 2, "guess": [2, 3], "adam": [2, 3], "decai": 2, "learn": [2, 3], "iter": [2, 3], "name": 2, "tupl": 2, "contain": 2, "opt_stat": [2, 3], "final": [2, 3], "histori": [2, 3], "object": [2, 3], "minimize_lbfgsb": 2, "auto": [3, 4], "bfg": 3, "b": 3, "perform": 3, "cach": 3, "so": 3, "user": 3, "view": 3, "save": 3, "time": [3, 4], "precomput": 3, "new": 3, "gener": [3, 4], "must": 3, "curri": 3, "form": 3, "If": [3, 4], "less": [3, 4], "than": [3, 4], "greater": [3, 4], "equal": [3, 4], "doe": 3, "induc": 3, "n": [3, 4], "exact": [3, 4], "le": [3, 4], "size": [3, 4], "includ": [3, 4], "account": [3, 4], "specifi": [3, 4], "percentag": [3, 4], "str": [3, 4], "explicitli": [3, 4], "whether": [3, 4], "interpret": [3, 4], "fix": [3, 4], "eigenvector": [3, 4], "percent": [3, 4], "provid": 3, "explict": 3, "clarifi": 3, "ambigu": 3, "v": 3, "bind": 3, "numer": [3, 5], "stabilit": 3, "stochast": 3, "maximum": [3, 4, 5], "posteriori": [3, 4], "quantiz": 3, "ignor": 3, "kdtree": 3, "20": 3, "balltre": 3, "otherwis": 3, "dimansion": 3, "embed": 3, "axi": [3, 4], "1th": [3, 4], "percentil": [3, 4], "mle": [3, 4, 5], "nn": [3, 4, 5], "_": [3, 4, 5], "gamma": [3, 4, 5], "pi": [3, 4, 5], "geometr": [3, 4], "constant": [3, 4], "explictli": 3, "ha": 3, "effect": 3, "find": 3, "lz": [3, 4], "bool": 3, "jax": 3, "just": 3, "compil": 3, "dure": 3, "when": 3, "befor": 3, "throughout": 3, "log_density_func": 3, "build_predict": 3, "true": 3, "end": 3, "conput": 3, "line": 3, "gradiant": 3, "hessian_log_determin": 3, "logarirhm": 3, "determinat": 3, "sign": 3, "log_determin": 3, "determin": 3, "logarithm": 3, "absolut": 3, "attribut": 3, "prepar": 3, "do": 3, "It": 3, "necessari": 3, "store": 3, "procedur": 3, "loss_funct": 3, "full": 4, "decompost": 4, "compute_cov_func": 4, "compute_d": 4, "argmin": 4, "compute_landmark": 4, "landmark_point": 4, "given": 5, "whole": 2, "domain": 2, "fast": 2, "spars": 2}, "objects": {"mellon": [[0, 0, 0, "-", "cov"], [2, 0, 0, "-", "inference"], [3, 0, 0, "-", "model"], [4, 0, 0, "-", "parameters"], [5, 0, 0, "-", "util"]], "mellon.cov": [[0, 1, 1, "", "ExpQuad"], [0, 1, 1, "", "Exponential"], [0, 1, 1, "", "Matern32"], [0, 1, 1, "", "Matern52"], [0, 1, 1, "", "RatQuad"]], "mellon.cov.ExpQuad": [[0, 2, 1, "", "k"]], "mellon.cov.Exponential": [[0, 2, 1, "", "k"]], "mellon.cov.Matern32": [[0, 2, 1, "", "k"]], "mellon.cov.Matern52": [[0, 2, 1, "", "k"]], "mellon.cov.RatQuad": [[0, 2, 1, "", "k"]], "mellon.inference": [[2, 3, 1, "", "compute_conditional_mean"], [2, 3, 1, "", "compute_log_density_x"], [2, 3, 1, "", "compute_loss_func"], [2, 3, 1, "", "compute_transform"], [2, 3, 1, "", "minimize_adam"], [2, 3, 1, "", "minimize_lbfgsb"]], "mellon.model": [[3, 1, 1, "", "DensityEstimator"]], "mellon.model.DensityEstimator": [[3, 2, 1, "", "fit"], [3, 2, 1, "", "fit_predict"], [3, 2, 1, "", "gradient"], [3, 2, 1, "", "hessian"], [3, 2, 1, "", "hessian_log_determinant"], [3, 2, 1, "", "predict"], [3, 2, 1, "", "prepare_inference"], [3, 2, 1, "", "process_inference"], [3, 2, 1, "", "run_inference"]], "mellon.parameters": [[4, 3, 1, "", "compute_L"], [4, 3, 1, "", "compute_cov_func"], [4, 3, 1, "", "compute_d"], [4, 3, 1, "", "compute_initial_value"], [4, 3, 1, "", "compute_landmarks"], [4, 3, 1, "", "compute_ls"], [4, 3, 1, "", "compute_mu"], [4, 3, 1, "", "compute_nn_distances"]], "mellon.util": [[5, 3, 1, "", "distance"], [5, 3, 1, "", "mle"], [5, 3, 1, "", "stabilize"]]}, "objtypes": {"0": "py:module", "1": "py:class", "2": "py:method", "3": "py:function"}, "objnames": {"0": ["py", "module", "Python module"], "1": ["py", "class", "Python class"], "2": ["py", "method", "Python method"], "3": ["py", "function", "Python function"]}, "titleterms": {"covari": 0, "function": 0, "implement": 0, "instal": 1, "basic": 1, "usag": 1, "scanpi": 1, "paramet": [1, 4], "stage": 1, "api": 1, "deriv": 1, "index": 1, "infer": 2, "model": 3, "select": 4, "util": 5}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 8, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx": 57}, "alltitles": {"Covariance Functions": [[0, "covariance-functions"]], "Implemented Covariance Functions": [[0, "module-mellon.cov"]], "Parameter Selection": [[4, "module-mellon.parameters"]], "Utilities": [[5, "module-mellon.util"]], "Installation": [[1, "installation"]], "Basic Usage": [[1, "basic-usage"]], "Usage with Scanpy": [[1, "usage-with-scanpy"]], "Parameters": [[1, "parameters"]], "Stages API": [[1, "stages-api"]], "Derivatives": [[1, "derivatives"]], "Index": [[1, "index"]], "Inference": [[2, "module-mellon.inference"]], "Model": [[3, "module-mellon.model"]]}, "indexentries": {"compute_conditional_mean() (in module mellon.inference)": [[2, "mellon.inference.compute_conditional_mean"]], "compute_log_density_x() (in module mellon.inference)": [[2, "mellon.inference.compute_log_density_x"]], "compute_loss_func() (in module mellon.inference)": [[2, "mellon.inference.compute_loss_func"]], "compute_transform() (in module mellon.inference)": [[2, "mellon.inference.compute_transform"]], "mellon.inference": [[2, "module-mellon.inference"]], "minimize_adam() (in module mellon.inference)": [[2, "mellon.inference.minimize_adam"]], "minimize_lbfgsb() (in module mellon.inference)": [[2, "mellon.inference.minimize_lbfgsb"]], "module": [[2, "module-mellon.inference"], [3, "module-mellon.model"]], "densityestimator (class in mellon.model)": [[3, "mellon.model.DensityEstimator"]], "fit() (mellon.model.densityestimator method)": [[3, "mellon.model.DensityEstimator.fit"]], "fit_predict() (mellon.model.densityestimator method)": [[3, "mellon.model.DensityEstimator.fit_predict"]], "gradient() (mellon.model.densityestimator method)": [[3, "mellon.model.DensityEstimator.gradient"]], "hessian() (mellon.model.densityestimator method)": [[3, "mellon.model.DensityEstimator.hessian"]], "hessian_log_determinant() (mellon.model.densityestimator method)": [[3, "mellon.model.DensityEstimator.hessian_log_determinant"]], "mellon.model": [[3, "module-mellon.model"]], "predict() (mellon.model.densityestimator method)": [[3, "mellon.model.DensityEstimator.predict"]], "prepare_inference() (mellon.model.densityestimator method)": [[3, "mellon.model.DensityEstimator.prepare_inference"]], "process_inference() (mellon.model.densityestimator method)": [[3, "mellon.model.DensityEstimator.process_inference"]], "run_inference() (mellon.model.densityestimator method)": [[3, "mellon.model.DensityEstimator.run_inference"]]}})