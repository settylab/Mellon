Search.setIndex({"docnames": ["base_cov", "cov", "index", "inference", "model", "parameters", "util"], "filenames": ["base_cov.rst", "cov.rst", "index.rst", "inference.rst", "model.rst", "parameters.rst", "util.rst"], "titles": ["base_cov", "cov", "Installation", "inference", "model", "parameters", "util"], "terms": {"crowd": [0, 1, 2, 3, 4, 5, 6], "i": [2, 3, 4, 5], "non": [2, 4], "parametr": [2, 4], "densiti": [2, 3, 4, 6], "estim": [2, 4, 6], "base": [0, 1, 2, 4], "nearestneighbor": 2, "distribut": [2, 6], "To": 2, "pip": 2, "you": [2, 4], "can": [2, 3, 4], "run": [2, 4], "import": 2, "numpi": 2, "np": 2, "from": [2, 4, 5], "crowdingestim": [2, 4], "x": [1, 2, 3, 4, 5, 6], "random": 2, "rand": 2, "100": [2, 3, 4], "10": [2, 4, 5], "arbitrari": [2, 4], "train": [2, 3, 4, 5], "data": [2, 3, 4, 5, 6], "y": [1, 2, 4, 5, 6], "test": [2, 4], "model": [2, 3], "log_density_x": [2, 3, 4], "fit_predict": [2, 4], "log_density_i": 2, "predict": [2, 3, 4], "abov": 2, "all": [2, 4], "ar": [2, 4], "set": [2, 4, 6], "automat": [2, 4], "The": [2, 3, 4, 5, 6], "follow": 2, "code": 2, "equival": [2, 3], "ani": 2, "chang": 2, "desir": 2, "matern52": [1, 2, 4], "compute_landmark": 5, "compute_nn_dist": [2, 5], "compute_d": 5, "compute_mu": [2, 5], "compute_l": [2, 5], "compute_cov_func": 5, "compute_initial_valu": [2, 5], "cov_func_curri": [2, 4, 5], "higher": [], "n_landmark": [2, 4, 5], "alwai": [], "better": [], "more": [], "expens": [], "5000": [2, 4, 5], "rank": [2, 4, 5], "0": [1, 2, 3, 4, 5], "999": [2, 4, 5], "gener": [4, 5], "unnecessari": [], "clarifi": 4, "ambigu": 4, "case": [2, 4], "where": [3, 4, 5], "1": [1, 2, 3, 4, 5, 6], "method": [2, 4, 5], "auto": [4, 5], "increas": 2, "matrix": [2, 3, 4, 5, 6], "posit": [], "definit": [], "jitter": [2, 3, 4, 5, 6], "1e": [3, 4, 5, 6], "6": [3, 4, 5, 6], "sigma2": [], "landmark": [2, 3, 4, 5], "point": [2, 3, 4, 5, 6], "should": 2, "summar": [], "best": 2, "wai": 2, "choos": [], "an": [2, 4, 5], "open": [], "problem": [], "nn_distanc": [2, 3, 4, 5, 6], "mai": 2, "vari": 2, "fewer": [], "dimens": [2, 3, 6], "local": [2, 4, 5, 6], "scale": [2, 4, 5], "d": [2, 3, 4, 5, 6], "mu": [2, 3, 4, 5], "smaller": [], "than": [4, 5], "most": [], "datapoint": 5, "so": 4, "log": [2, 3, 4, 5, 6], "decai": 3, "awai": [2, 4], "us": [2, 3, 4, 5], "mle": [4, 5, 6], "util": [], "modul": 2, "initi": [2, 3, 4, 5], "noisi": [], "length": [2, 4, 5], "produc": 2, "smoother": [], "l": [1, 2, 3, 4, 5], "cov_func": [2, 3, 4, 5], "initial_valu": [3, 4, 5], "same": [], "basin": [], "global": [], "minimum": [], "instead": 2, "fit": [2, 4], "split": 2, "three": 2, "prepare_infer": [2, 4], "run_infer": [2, 4], "process_infer": [2, 4], "thi": [2, 4], "allow": 2, "make": 2, "intermedi": [2, 4], "For": 2, "exampl": 2, "would": [2, 4], "like": [2, 3, 4, 5, 6], "your": [2, 4], "own": [2, 4], "optim": [2, 3, 4, 5], "o": 2, "replac": 2, "def": 2, "loss_func": [2, 3, 4], "return": [2, 3, 4, 5, 6], "optimal_paramet": 2, "pre_transform": [2, 3, 4], "see": 2, "cov": [2, 4], "list": 2, "alreadi": 2, "implement": 2, "section": 2, "show": 2, "differ": 2, "suppli": [2, 4], "defin": 2, "argument": [2, 4], "support": [0, 2, 4, 5], "one": [2, 4], "class": [0, 1, 2, 4], "type": [2, 3, 4, 5, 6], "k": [1, 2, 3, 4, 5], "rightarrow": [2, 3, 4, 5], "float": [2, 3, 4, 5, 6], "In": 2, "which": 2, "comput": [2, 3, 4, 5, 6], "pass": [2, 4], "predefin": 2, "default": [2, 3, 4, 5, 6], "behavior": 2, "write": 2, "variabl": [2, 4], "distanc": [2, 3, 4, 5, 6], "between": [2, 4, 6], "each": [2, 3, 4, 5, 6], "r": 2, "similar": 2, "sqrt": [1, 2], "5": [1, 2], "squar": [2, 6], "3": [1, 2], "exp": 2, "inherit": 2, "__call__": 2, "call": [2, 4], "It": [2, 4], "also": [2, 4], "ad": [0, 2, 4, 6], "multipli": [0, 2], "take": [0, 2, 4], "power": [0, 2], "oper": [0, 2], "__init__": 2, "self": [2, 4], "super": 2, "altern": 2, "two": 2, "instanti": 2, "matern52_k": 2, "instati": 2, "exponenti": [1, 2, 3], "index": 2, "add": [0, 3, 4, 5, 6], "left": 0, "right": 0, "covari": [0, 1, 3, 4, 5], "function": [0, 3, 4, 5], "object": [0, 3, 4], "mul": 0, "pow": 0, "expquad": [1, 2], "e": [1, 2, 4], "frac": 1, "2": [1, 4, 5, 6], "2l": 1, "matern32": 1, "cdot": [1, 4, 5, 6], "3l": 1, "ratquad": 1, "alpha": 1, "compute_conditional_mean": 3, "06": [3, 4, 5, 6], "build": [3, 4], "mean": [2, 3, 4, 5], "gaussian": [2, 3, 4, 5], "process": [2, 3, 4, 5], "condit": [2, 3], "log_dens": [2, 3, 4], "valu": [2, 3, 4, 5], "paramet": [3, 4, 6], "arrai": [3, 4, 5, 6], "instanc": [3, 4, 5], "none": [3, 4, 5], "log_densities_x": 3, "origin": 3, "A": [2, 3, 4, 5, 6], "small": [3, 4, 5, 6], "amount": [3, 4, 5, 6], "diagon": [3, 4, 5, 6], "stabil": [3, 4, 6], "white": [], "nois": [], "varianc": 2, "conditional_mean": 3, "compute_log_density_x": 3, "transform": [3, 4], "z": [3, 4, 5], "sim": [3, 4], "text": [3, 4, 5, 6], "normal": [3, 4], "f": 3, "ident": [3, 4], "approx": [3, 4, 5], "top": [3, 4, 5], "compute_loss_func": 3, "bayesian": [3, 4], "loss": [3, 4], "prior": [3, 4], "likelihood": [3, 4, 6], "observ": [3, 5, 6], "nearest": [2, 3, 4, 5, 6], "neighbor": [2, 3, 4, 5, 6], "int": [3, 4, 5, 6], "dimension": [2, 3, 4, 5, 6], "map": [2, 3, 4], "input": [2, 3], "compute_transform": 3, "run_inference_adam": [], "n_iter": [3, 4], "init_learn_r": [3, 4], "jit": [3, 4], "fals": [3, 4], "minim": [3, 4, 5], "start": 3, "guess": [3, 4], "adam": [3, 4], "learn": [3, 4], "rate": [2, 3, 4], "integ": [2, 3], "number": [2, 3, 4, 5], "iter": [3, 4], "result": [2, 3, 4], "name": 3, "tupl": 3, "contain": 3, "opt_stat": [3, 4], "final": [3, 4], "state": [2, 3, 4], "histori": [3, 4], "run_inference_lbfgsb": [], "param": [], "bfg": 4, "b": 4, "perform": 4, "infer": [2, 4], "cach": 4, "user": 4, "view": 4, "save": 4, "time": [4, 5], "precomput": 4, "new": 4, "must": 4, "curri": 4, "form": 4, "If": [4, 5], "less": [4, 5], "greater": [4, 5], "equal": [4, 5], "doe": 4, "induc": 4, "approxim": [2, 4, 5], "n": 4, "exact": [4, 5], "le": [4, 5], "size": [4, 5], "select": [2, 4], "includ": [4, 5], "eigenvalu": [2, 4, 5], "account": [4, 5], "specifi": [4, 5], "percentag": [4, 5], "total": [2, 4, 5], "str": [4, 5], "explicitli": [4, 5], "whether": [4, 5], "interpret": [4, 5], "fix": [4, 5], "eigenvector": [4, 5], "percent": [4, 5], "low": [2, 4, 5], "provid": 4, "explict": 4, "v": 4, "numer": [4, 6], "stabilit": 4, "quantiz": 4, "centroid": [2, 4, 5], "ignor": 4, "kdtree": 4, "20": 4, "balltre": 4, "otherwis": 4, "axi": [4, 5], "1th": [4, 5], "percentil": [4, 5], "nn": [4, 5, 6], "_": [4, 5, 6], "gamma": [4, 5, 6], "pi": [4, 5, 6], "geometr": [4, 5], "constant": [4, 5], "explictli": 4, "ha": 4, "effect": 4, "find": 4, "lz": [4, 5], "stochast": 4, "maximum": [4, 5, 6], "posteriori": [4, 5], "bool": 4, "jax": 4, "just": 4, "compil": 4, "its": [2, 4, 5], "gradient": [2, 4], "dure": 4, "befor": 4, "last": [], "step": [], "throughout": 4, "log_density_func": 4, "build_predict": 4, "true": 4, "end": 4, "note": [], "slightli": [], "due": [], "attribut": 4, "prepar": 4, "do": 4, "necessari": 4, "store": 4, "procedur": 4, "loss_funct": 4, "full": 5, "decompost": 5, "standard": 5, "nystrom": 5, "reduc": [2, 5], "further": [2, 5], "qr": 5, "decomposit": 5, "ridg": [2, 5], "regress": [2, 5], "argmin": 5, "landmark_point": 5, "given": 6, "dimansion": 4, "embed": 4, "manifold": [2, 4], "when": 4, "latent": [2, 4], "represent": [2, 4], "bind": 4, "ensur": [2, 4], "neigbor": [], "cell": 2, "block": [], "scd": 2, "One": 2, "aspect": 2, "through": 2, "control": 2, "realiz": 2, "kernel": 2, "pair": 2, "By": 2, "we": 2, "heurist": 2, "twice": 2, "differenti": 2, "reason": 2, "bia": 2, "choic": 2, "g": 2, "length_scal": 2, "structur": 2, "henc": 2, "proxi": 2, "while": 2, "cluster": 2, "preform": 2, "our": 2, "limit": 2, "k_mean": 2, "n_init": 2, "furtehr": [], "improv": 2, "nystroem": [], "either": 2, "fraction": 2, "sum": 2, "preserv": 2, "choleski": 2, "factor": 2, "assum": 2, "along": 2, "howev": 2, "known": 2, "onli": 2, "tangenti": 2, "subspac": 2, "phenotip": [], "shouold": [], "correctli": 2, "relat": 2, "shape": [2, 4], "suggest": 2, "invari": 2, "drop": 2, "quickli": 2, "initit": [], "speed": 2, "up": 2, "posterior": [], "done": [], "extern": 2, "minimize_lbfgsb": 3, "deriv": [], "now": [], "hessian": [2, 4], "minimize_adam": 3, "conput": 4, "line": 4, "gradiant": 4, "hessian_log_determin": 4, "logarirhm": 4, "determinat": 4, "sign": 4, "log_determin": 4, "determin": 4, "logarithm": 4, "absolut": 4, "nystr\u00f6m": 2, "phenotyp": 2, "initial_paramet": 2, "after": 2, "Of": 2, "cours": 2, "work": 2, "recomend": 2, "diffus": 2, "sc": 2, "adata": 2, "read": 2, "h5ad_file_path": 2, "tl": 2, "palantir": 2, "ob": 2, "obsm": 2, "dm_eigenvector": 2, "subset": 2, "conplet": [], "dataset": 2, "sibset": [], "mask": 2, "subset_valu": 2, "maska": [], "complet": 2, "evalu": 2, "log_density_condit": 2}, "objects": {"Crowding": [[0, 0, 0, "-", "base_cov"], [1, 0, 0, "-", "cov"], [3, 0, 0, "-", "inference"], [4, 0, 0, "-", "model"], [5, 0, 0, "-", "parameters"], [6, 0, 0, "-", "util"]], "Crowding.base_cov": [[0, 1, 1, "", "Add"], [0, 1, 1, "", "Covariance"], [0, 1, 1, "", "Mul"], [0, 1, 1, "", "Pow"]], "Crowding.cov": [[1, 1, 1, "", "ExpQuad"], [1, 1, 1, "", "Exponential"], [1, 1, 1, "", "Matern32"], [1, 1, 1, "", "Matern52"], [1, 1, 1, "", "RatQuad"]], "Crowding.cov.ExpQuad": [[1, 2, 1, "", "k"]], "Crowding.cov.Exponential": [[1, 2, 1, "", "k"]], "Crowding.cov.Matern32": [[1, 2, 1, "", "k"]], "Crowding.cov.Matern52": [[1, 2, 1, "", "k"]], "Crowding.cov.RatQuad": [[1, 2, 1, "", "k"]], "Crowding.inference": [[3, 3, 1, "", "compute_conditional_mean"], [3, 3, 1, "", "compute_log_density_x"], [3, 3, 1, "", "compute_loss_func"], [3, 3, 1, "", "compute_transform"], [3, 3, 1, "", "minimize_adam"], [3, 3, 1, "", "minimize_lbfgsb"]], "Crowding.model": [[4, 1, 1, "", "CrowdingEstimator"]], "Crowding.model.CrowdingEstimator": [[4, 2, 1, "", "fit"], [4, 2, 1, "", "fit_predict"], [4, 2, 1, "", "gradient"], [4, 2, 1, "", "hessian"], [4, 2, 1, "", "hessian_log_determinant"], [4, 2, 1, "", "predict"], [4, 2, 1, "", "prepare_inference"], [4, 2, 1, "", "process_inference"], [4, 2, 1, "", "run_inference"]], "Crowding.parameters": [[5, 3, 1, "", "compute_L"], [5, 3, 1, "", "compute_cov_func"], [5, 3, 1, "", "compute_d"], [5, 3, 1, "", "compute_initial_value"], [5, 3, 1, "", "compute_landmarks"], [5, 3, 1, "", "compute_ls"], [5, 3, 1, "", "compute_mu"], [5, 3, 1, "", "compute_nn_distances"]], "Crowding.util": [[6, 3, 1, "", "distance"], [6, 3, 1, "", "mle"], [6, 3, 1, "", "stabilize"]]}, "objtypes": {"0": "py:module", "1": "py:class", "2": "py:method", "3": "py:function"}, "objnames": {"0": ["py", "module", "Python module"], "1": ["py", "class", "Python class"], "2": ["py", "method", "Python method"], "3": ["py", "function", "Python function"]}, "titleterms": {"base_cov": 0, "cov": 1, "instal": 2, "basic": 2, "usag": 2, "paramet": [2, 5], "stage": 2, "api": 2, "covari": 2, "function": 2, "indic": 2, "infer": 3, "model": 4, "util": 6, "deriv": 2, "scanpi": 2}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 8, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx": 57}, "alltitles": {"parameters": [[5, "module-Crowding.parameters"]], "util": [[6, "module-Crowding.util"]], "base_cov": [[0, "module-Crowding.base_cov"]], "cov": [[1, "module-Crowding.cov"]], "inference": [[3, "module-Crowding.inference"]], "model": [[4, "module-Crowding.model"]], "Installation": [[2, "installation"]], "Basic Usage": [[2, "basic-usage"]], "Usage with scanpy": [[2, "usage-with-scanpy"]], "Parameters": [[2, "parameters"]], "Stages API": [[2, "stages-api"]], "Derivatives": [[2, "derivatives"]], "Covariance Functions": [[2, "covariance-functions"]], "Indices": [[2, "indices"]]}, "indexentries": {}})