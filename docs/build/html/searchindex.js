Search.setIndex({"docnames": ["cov", "index", "inference", "model", "parameters", "util"], "filenames": ["cov.rst", "index.rst", "inference.rst", "model.rst", "parameters.rst", "util.rst"], "titles": ["Covariance Functions", "Installation", "Inference", "Model", "Parameter Selection", "Utilities"], "terms": {"crowd": [0, 1, 2, 3, 4, 5], "i": [1, 2, 3, 4], "non": [1, 3], "parametr": [1, 3], "densiti": [1, 2, 3, 5], "estim": [1, 3, 5], "base": [0, 1, 3], "nearestneighbor": 1, "distribut": [1, 5], "To": 1, "pip": 1, "you": [1, 3], "can": [0, 1, 2, 3], "run": [1, 3], "import": [0, 1], "numpi": 1, "np": 1, "from": [0, 1, 3, 4], "crowdingestim": [1, 3], "x": [0, 1, 2, 3, 4, 5], "random": 1, "rand": 1, "100": [1, 2, 3], "10": [1, 3, 4], "arbitrari": [1, 3], "train": [1, 2, 3, 4], "data": [1, 2, 3, 4, 5], "y": [0, 1, 3, 4, 5], "test": [1, 3], "model": [0, 1, 2], "log_density_x": [1, 2, 3], "fit_predict": [1, 3], "log_density_i": 1, "predict": [1, 2, 3], "abov": 1, "all": [1, 3], "ar": [1, 3], "set": [0, 1, 3, 5], "automat": [0, 1, 3], "The": [0, 1, 2, 3, 4, 5], "follow": 1, "code": 1, "equival": [1, 2], "ani": 1, "chang": 1, "desir": 1, "matern52": [0, 1, 3], "compute_landmark": 4, "compute_nn_dist": [1, 4], "compute_d": 4, "compute_mu": [1, 4], "compute_l": [1, 4], "compute_cov_func": 4, "compute_initial_valu": [1, 4], "cov_func_curri": [0, 3, 4], "higher": [], "n_landmark": [1, 3, 4], "alwai": [], "better": [], "more": [], "expens": [], "5000": [1, 3, 4], "rank": [1, 3, 4], "0": [0, 1, 2, 3, 4], "999": [1, 3, 4], "gener": [3, 4], "unnecessari": [], "clarifi": 3, "ambigu": 3, "case": [0, 3], "where": [2, 3, 4], "1": [0, 1, 2, 3, 4, 5], "method": [0, 1, 3, 4], "auto": [3, 4], "increas": 1, "matrix": [1, 2, 3, 4, 5], "posit": [], "definit": [], "jitter": [1, 2, 3, 4, 5], "1e": [2, 3, 4, 5], "6": [2, 3, 4, 5], "sigma2": [], "landmark": [1, 2, 3, 4], "point": [0, 2, 3, 4, 5], "should": 1, "summar": [], "best": 1, "wai": 0, "choos": [], "an": [0, 1, 3, 4], "open": [], "problem": [], "nn_distanc": [1, 2, 3, 4, 5], "mai": 1, "vari": 1, "fewer": [], "dimens": [1, 2, 5], "local": [1, 3, 4, 5], "scale": [0, 1, 3, 4], "d": [1, 2, 3, 4, 5], "mu": [1, 2, 3, 4], "smaller": [], "than": [3, 4], "most": [], "datapoint": 4, "so": 3, "log": [1, 2, 3, 4, 5], "decai": 2, "awai": [1, 3], "us": [0, 1, 2, 3, 4], "mle": [3, 4, 5], "util": [], "modul": 1, "initi": [1, 2, 3, 4], "noisi": [], "length": [0, 1, 3, 4], "produc": 1, "smoother": [], "l": [0, 1, 2, 3, 4], "cov_func": [0, 1, 2, 3, 4], "initial_valu": [2, 3, 4], "same": [], "basin": [], "global": [], "minimum": [], "instead": 1, "fit": [1, 3], "split": 1, "three": 1, "prepare_infer": [1, 3], "run_infer": [1, 3], "process_infer": [1, 3], "thi": [0, 1, 3], "allow": 1, "make": 1, "intermedi": [1, 3], "For": 1, "exampl": 1, "would": [1, 3], "like": [1, 2, 3, 4, 5], "your": [0, 1, 3], "own": [0, 1, 3], "optim": [1, 2, 3, 4], "o": 1, "replac": 1, "def": [0, 1], "loss_func": [1, 2, 3], "return": [0, 1, 2, 3, 4, 5], "optimal_paramet": 1, "pre_transform": [1, 2, 3], "see": [], "cov": [0, 3], "list": [], "alreadi": [], "implement": [], "section": 0, "show": 0, "differ": 0, "suppli": [0, 3], "defin": 0, "argument": [0, 3], "support": [0, 3, 4], "one": [0, 3], "class": [0, 3], "type": [0, 2, 3, 4, 5], "k": [0, 1, 2, 3, 4], "rightarrow": [0, 2, 3, 4], "float": [0, 2, 3, 4, 5], "In": 0, "which": [], "comput": [0, 1, 2, 3, 4, 5], "pass": [0, 3], "predefin": 0, "default": [0, 1, 2, 3, 4, 5], "behavior": 0, "write": 0, "variabl": [0, 3], "distanc": [0, 1, 2, 3, 4, 5], "between": [0, 1, 3, 5], "each": [0, 1, 2, 3, 4, 5], "r": 0, "similar": [0, 1], "sqrt": 0, "5": 0, "squar": [0, 5], "3": 0, "exp": 0, "inherit": 0, "__call__": 0, "call": [0, 3], "It": [0, 3], "also": [0, 1, 3], "ad": [0, 3, 5], "multipli": 0, "take": [0, 3], "power": 0, "oper": 0, "__init__": 0, "self": [0, 3], "super": 0, "altern": [0, 1], "two": 0, "instanti": [], "matern52_k": [], "instati": [], "exponenti": [0, 2], "index": 1, "add": [2, 3, 4, 5], "left": [], "right": [], "covari": [1, 2, 3, 4], "function": [1, 2, 3, 4], "object": [2, 3], "mul": [], "pow": [], "expquad": [0, 1], "e": [0, 1, 3], "frac": 0, "2": [0, 3, 4, 5], "2l": 0, "matern32": 0, "cdot": [0, 3, 4, 5], "3l": 0, "ratquad": 0, "alpha": 0, "compute_conditional_mean": 2, "06": [2, 3, 4, 5], "build": [2, 3], "mean": [1, 2, 3, 4], "gaussian": [1, 2, 3, 4], "process": [1, 2, 3, 4], "condit": [1, 2], "log_dens": [1, 2, 3], "valu": [1, 2, 3, 4], "paramet": [2, 3, 5], "arrai": [0, 2, 3, 4, 5], "instanc": [2, 3, 4], "none": [2, 3, 4], "log_densities_x": 2, "origin": 2, "A": [1, 2, 3, 4, 5], "small": [2, 3, 4, 5], "amount": [2, 3, 4, 5], "diagon": [2, 3, 4, 5], "stabil": [2, 3, 5], "white": [], "nois": 1, "varianc": 1, "conditional_mean": 2, "compute_log_density_x": 2, "transform": [2, 3], "z": [2, 3, 4], "sim": [2, 3], "text": [2, 3, 4, 5], "normal": [2, 3], "f": 2, "ident": [2, 3], "approx": [2, 3, 4], "top": [2, 3, 4], "compute_loss_func": 2, "bayesian": [2, 3], "loss": [2, 3], "prior": [2, 3], "likelihood": [2, 3, 5], "observ": [2, 4, 5], "nearest": [1, 2, 3, 4, 5], "neighbor": [1, 2, 3, 4, 5], "int": [2, 3, 4, 5], "dimension": [1, 2, 3, 4, 5], "map": [1, 2, 3], "input": [1, 2], "compute_transform": 2, "run_inference_adam": [], "n_iter": [2, 3], "init_learn_r": [2, 3], "jit": [2, 3], "fals": [2, 3], "minim": [2, 3, 4], "start": 2, "guess": [2, 3], "adam": [2, 3], "learn": [2, 3], "rate": [1, 2, 3], "integ": [1, 2], "number": [1, 2, 3, 4], "iter": [2, 3], "result": [1, 2, 3], "name": 2, "tupl": 2, "contain": 2, "opt_stat": [2, 3], "final": [2, 3], "state": [0, 1, 2, 3], "histori": [2, 3], "run_inference_lbfgsb": [], "param": [], "bfg": 3, "b": 3, "perform": 3, "infer": [1, 3], "cach": 3, "user": 3, "view": 3, "save": 3, "time": [3, 4], "precomput": 3, "new": 3, "must": 3, "curri": 3, "form": 3, "If": [3, 4], "less": [3, 4], "greater": [3, 4], "equal": [3, 4], "doe": 3, "induc": 3, "approxim": [1, 3, 4], "n": 3, "exact": [3, 4], "le": [3, 4], "size": [3, 4], "select": [1, 3], "includ": [3, 4], "eigenvalu": [1, 3, 4], "account": [3, 4], "specifi": [3, 4], "percentag": [3, 4], "total": [1, 3, 4], "str": [3, 4], "explicitli": [3, 4], "whether": [3, 4], "interpret": [3, 4], "fix": [3, 4], "eigenvector": [3, 4], "percent": [3, 4], "low": [1, 3, 4], "provid": 3, "explict": 3, "v": 3, "numer": [3, 5], "stabilit": 3, "quantiz": 3, "centroid": [1, 3, 4], "ignor": 3, "kdtree": 3, "20": 3, "balltre": 3, "otherwis": 3, "axi": [3, 4], "1th": [3, 4], "percentil": [3, 4], "nn": [3, 4, 5], "_": [3, 4, 5], "gamma": [3, 4, 5], "pi": [3, 4, 5], "geometr": [3, 4], "constant": [3, 4], "explictli": 3, "ha": 3, "effect": 3, "find": 3, "lz": [3, 4], "stochast": 3, "maximum": [3, 4, 5], "posteriori": [3, 4], "bool": 3, "jax": 3, "just": 3, "compil": 3, "its": [1, 3, 4], "gradient": [1, 3], "dure": 3, "befor": 3, "last": [], "step": [], "throughout": 3, "log_density_func": 3, "build_predict": 3, "true": 3, "end": 3, "note": [], "slightli": [], "due": [], "attribut": 3, "prepar": 3, "do": 3, "necessari": 3, "store": 3, "procedur": 3, "loss_funct": 3, "full": 4, "decompost": 4, "standard": 4, "nystrom": 4, "reduc": [1, 4], "further": [1, 4], "qr": 4, "decomposit": 4, "ridg": [1, 4], "regress": [1, 4], "argmin": 4, "landmark_point": 4, "given": 5, "dimansion": 3, "embed": 3, "manifold": [1, 3], "when": 3, "latent": [1, 3], "represent": [1, 3], "bind": 3, "ensur": [1, 3], "neigbor": [], "cell": [0, 1], "block": [], "scd": 1, "One": 1, "aspect": 1, "through": 1, "control": 1, "realiz": 1, "kernel": 1, "pair": [0, 1], "By": 1, "we": 1, "heurist": 1, "twice": 1, "differenti": 1, "reason": 1, "bia": 1, "choic": 1, "g": 1, "length_scal": [0, 1], "structur": 1, "henc": 1, "proxi": 1, "while": 1, "cluster": 1, "preform": 1, "our": 1, "limit": 1, "k_mean": 1, "n_init": 1, "furtehr": [], "improv": 1, "nystroem": [], "either": 1, "fraction": 1, "sum": 1, "preserv": 1, "choleski": 1, "factor": 1, "assum": 1, "along": 1, "howev": 1, "known": 1, "onli": 1, "tangenti": 1, "subspac": 1, "phenotip": [], "shouold": [], "correctli": 1, "relat": 1, "shape": [1, 3], "suggest": 1, "invari": 1, "drop": 1, "quickli": 1, "initit": [], "speed": 1, "up": 1, "posterior": [], "done": [], "extern": 1, "minimize_lbfgsb": 2, "deriv": [], "now": [], "hessian": [1, 3], "minimize_adam": 2, "conput": 3, "line": 3, "gradiant": 3, "hessian_log_determin": 3, "logarirhm": 3, "determinat": 3, "sign": 3, "log_determin": 3, "determin": 3, "logarithm": 3, "absolut": 3, "nystr\u00f6m": 1, "phenotyp": 1, "initial_paramet": 1, "after": 1, "Of": 1, "cours": 1, "work": 1, "recomend": 1, "diffus": 1, "sc": 1, "adata": 1, "read": 1, "h5ad_file_path": 1, "tl": 1, "palantir": 1, "ob": 1, "obsm": 1, "dm_eigenvector": 1, "subset": 1, "conplet": [], "dataset": 1, "sibset": [], "mask": 1, "subset_valu": 1, "maska": [], "complet": 1, "evalu": 1, "log_density_condit": 1, "represnt": 1, "euclidian": 1, "disimilar": 1, "some": 1, "meaningless": 1, "remov": 1, "roghli": 1, "cov_func_curi": 0, "simialar": 0, "algebra": 0, "combin": 0, "7": 0, "similat": 0}, "objects": {"Crowding": [[0, 0, 0, "-", "cov"], [2, 0, 0, "-", "inference"], [3, 0, 0, "-", "model"], [4, 0, 0, "-", "parameters"], [5, 0, 0, "-", "util"]], "Crowding.cov": [[0, 1, 1, "", "ExpQuad"], [0, 1, 1, "", "Exponential"], [0, 1, 1, "", "Matern32"], [0, 1, 1, "", "Matern52"], [0, 1, 1, "", "RatQuad"]], "Crowding.cov.ExpQuad": [[0, 2, 1, "", "k"]], "Crowding.cov.Exponential": [[0, 2, 1, "", "k"]], "Crowding.cov.Matern32": [[0, 2, 1, "", "k"]], "Crowding.cov.Matern52": [[0, 2, 1, "", "k"]], "Crowding.cov.RatQuad": [[0, 2, 1, "", "k"]], "Crowding.inference": [[2, 3, 1, "", "compute_conditional_mean"], [2, 3, 1, "", "compute_log_density_x"], [2, 3, 1, "", "compute_loss_func"], [2, 3, 1, "", "compute_transform"], [2, 3, 1, "", "minimize_adam"], [2, 3, 1, "", "minimize_lbfgsb"]], "Crowding.model": [[3, 1, 1, "", "CrowdingEstimator"]], "Crowding.model.CrowdingEstimator": [[3, 2, 1, "", "fit"], [3, 2, 1, "", "fit_predict"], [3, 2, 1, "", "gradient"], [3, 2, 1, "", "hessian"], [3, 2, 1, "", "hessian_log_determinant"], [3, 2, 1, "", "predict"], [3, 2, 1, "", "prepare_inference"], [3, 2, 1, "", "process_inference"], [3, 2, 1, "", "run_inference"]], "Crowding.parameters": [[4, 3, 1, "", "compute_L"], [4, 3, 1, "", "compute_cov_func"], [4, 3, 1, "", "compute_d"], [4, 3, 1, "", "compute_initial_value"], [4, 3, 1, "", "compute_landmarks"], [4, 3, 1, "", "compute_ls"], [4, 3, 1, "", "compute_mu"], [4, 3, 1, "", "compute_nn_distances"]], "Crowding.util": [[5, 3, 1, "", "distance"], [5, 3, 1, "", "mle"], [5, 3, 1, "", "stabilize"]]}, "objtypes": {"0": "py:module", "1": "py:class", "2": "py:method", "3": "py:function"}, "objnames": {"0": ["py", "module", "Python module"], "1": ["py", "class", "Python class"], "2": ["py", "method", "Python method"], "3": ["py", "function", "Python function"]}, "titleterms": {"base_cov": [], "cov": [], "instal": 1, "basic": 1, "usag": 1, "paramet": [1, 4], "stage": 1, "api": 1, "covari": 0, "function": 0, "indic": 1, "infer": 2, "model": 3, "util": 5, "deriv": 1, "scanpi": 1, "select": 4, "implement": 0}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 8, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx": 57}, "alltitles": {"Installation": [[1, "installation"]], "Basic Usage": [[1, "basic-usage"]], "Usage with scanpy": [[1, "usage-with-scanpy"]], "Parameters": [[1, "parameters"]], "Stages API": [[1, "stages-api"]], "Derivatives": [[1, "derivatives"]], "Indices": [[1, "indices"]], "Inference": [[2, "module-Crowding.inference"]], "Model": [[3, "module-Crowding.model"]], "Parameter Selection": [[4, "module-Crowding.parameters"]], "Utilities": [[5, "module-Crowding.util"]], "Covariance Functions": [[0, "covariance-functions"]], "Implemented Covariance Functions": [[0, "module-Crowding.cov"]]}, "indexentries": {"crowding.cov": [[0, "module-Crowding.cov"]], "expquad (class in crowding.cov)": [[0, "Crowding.cov.ExpQuad"]], "exponential (class in crowding.cov)": [[0, "Crowding.cov.Exponential"]], "matern32 (class in crowding.cov)": [[0, "Crowding.cov.Matern32"]], "matern52 (class in crowding.cov)": [[0, "Crowding.cov.Matern52"]], "ratquad (class in crowding.cov)": [[0, "Crowding.cov.RatQuad"]], "k() (crowding.cov.expquad method)": [[0, "Crowding.cov.ExpQuad.k"]], "k() (crowding.cov.exponential method)": [[0, "Crowding.cov.Exponential.k"]], "k() (crowding.cov.matern32 method)": [[0, "Crowding.cov.Matern32.k"]], "k() (crowding.cov.matern52 method)": [[0, "Crowding.cov.Matern52.k"]], "k() (crowding.cov.ratquad method)": [[0, "Crowding.cov.RatQuad.k"]], "module": [[0, "module-Crowding.cov"]]}})